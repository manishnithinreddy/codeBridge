# Auto-scaling configuration for Session Service
# These properties are designed to help the service scale automatically based on load

# Import base scaling configuration
spring.profiles.include=scaling

# Connection Pool Configuration
codebridge.session.ssh.maxConnectionsPerInstance=2000
codebridge.session.ssh.connectionIdleTimeoutMs=180000
codebridge.session.ssh.cleanupIntervalMs=30000

# Command Queue Configuration
codebridge.session.command.corePoolSize=20
codebridge.session.command.maxPoolSize=100
codebridge.session.command.queueCapacity=2000
codebridge.session.command.keepAliveSeconds=30

# File Transfer Configuration
codebridge.session.transfer.chunkSizeBytes=1048576
codebridge.session.transfer.maxConcurrentTransfers=20
codebridge.session.transfer.tempDirectory=${java.io.tmpdir}/codebridge-transfers

# Redis Cluster Configuration
spring.redis.cluster.nodes=${REDIS_CLUSTER_NODES:localhost:6379}
spring.redis.cluster.max-redirects=3
spring.redis.timeout=2000
spring.redis.lettuce.shutdown-timeout=100
spring.redis.lettuce.pool.max-active=200
spring.redis.lettuce.pool.max-idle=50
spring.redis.lettuce.pool.min-idle=10

# Server Configuration for Scaling
server.tomcat.max-threads=400
server.tomcat.max-connections=20000
server.tomcat.accept-count=1000
server.tomcat.connection-timeout=3000

# Actuator Configuration for Auto-scaling
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.metrics.export.prometheus.enabled=true

# Resource Limits
# These are used by the container orchestration system (e.g., Kubernetes)
# to set resource limits and requests for the service
codebridge.resources.limits.cpu=2
codebridge.resources.limits.memory=4Gi
codebridge.resources.requests.cpu=500m
codebridge.resources.requests.memory=1Gi

# Auto-scaling Configuration
# These are used by the container orchestration system (e.g., Kubernetes)
# to configure horizontal pod autoscaling
codebridge.autoscaling.enabled=true
codebridge.autoscaling.minReplicas=2
codebridge.autoscaling.maxReplicas=20
codebridge.autoscaling.targetCpuUtilizationPercentage=70
codebridge.autoscaling.targetMemoryUtilizationPercentage=80

